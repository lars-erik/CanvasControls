<!DOCTYPE html>
<html>
<head>
	<title></title>
	
	<script src="Scripts/class.js" type="text/javascript"></script>
	<script src="Scripts/jquery-1.7.1.min.js" type="text/javascript"></script>
	<script src="Scripts/canvascontrols.js" type="text/javascript"></script>
	<script src="Scripts/canvascontrols.shape.js" type="text/javascript"></script>
	<script src="Scripts/canvascontrols.canvasview.js" type="text/javascript"></script>
	<script src="Scripts/canvascontrols.timeline.tree.js" type="text/javascript"></script>

	<style type="text/css">
			
	.menu {
		position: absolute;
		width: 100px;
		height: 100px;
		border: 1px solid black;
		background-color: #ECECEC;
		display: none;
	}
		
	</style>
</head>
<body>
	
	<canvas style="width:100%;height:600px;"></canvas>
	
	<div id="menu" class="menu">
		<span id="add">add</span><br/>
		<span id="remove">remove</span><br/>
	</div>

	<script type="text/javascript">

		var canvasView = new canvascontrols.CanvasView("canvas");
		var tree = new canvascontrols.TimelineTree();
		var box1 = new canvascontrols.TimelineTreeNode({
			label: "Boks 1"
		});
		var box2 = new canvascontrols.TimelineTreeNode({
			label: "Boks 2"
		});
		var childBox11 = new canvascontrols.TimelineTreeNode({
			label: "Boks 1.1"
		});
		var childBox12 = new canvascontrols.TimelineTreeNode({
			label: "Boks 1.2"
		});
		var childBox21 = new canvascontrols.TimelineTreeNode({
			label: "Boks 2.1"
		});
		var grandChildBox111 = new canvascontrols.TimelineTreeNode({
			label: "Boks 1.1.1"
		});
		var grandChildBox112 = new canvascontrols.TimelineTreeNode({
			label: "Boks 1.1.2"
		});
		box1.add(childBox11);
		box1.add(childBox12);
		box2.add(childBox21);
		childBox11.add(grandChildBox111);
		childBox11.add(grandChildBox112);
		tree.add(box1);
		tree.add(box2);
		canvasView.add(tree);

		var obj = new Object();
		tree.addListener(obj, handleEvent);

		canvasView.paint();

		var currentNode;

		function handleEvent(sender, event) {
			$("#menu").hide();
			switch (event) {
				case "toggle":
				case "nodeAdded":
					canvasView.paint();
					break;
				case "click":
					var data = arguments[3];
					if (data.button != "right") {
						return;
					}
					currentNode = arguments[2];
					$("#menu").css("left", $("canvas").position().left + data.originalX);
					$("#menu").css("top", $("canvas").position().top + data.originalY);
					$("#menu").show();
			}	
		}

		$("#add").click(function () {
			currentNode.add(new canvascontrols.TimelineTreeNode());
			$("#menu").hide();
		});

		$("#remove").click(function () {
			currentNode._parent.remove(currentNode);
			$("#menu").hide();
		});

	</script>
</body>
</html>
